<h2 class="page-title">
  Inventory Management
</h2>

<!-- Toast -->
<div *ngIf="toastMessage" class="toast">
  {{ toastMessage }}
</div>

<!-- Error Banner -->
<div *ngIf="error" class="error-banner">
  <span>{{ error }}</span>
  <button class="btn-red small" (click)="error = null">âœ–</button>
</div>

<!-- ===================== WAREHOUSE SELECT ===================== -->

<div class="card">

  <h3>Select Warehouse</h3>

  <select
    [(ngModel)]="selectedWarehouseId"
    (change)="loadInventory()"
  >
    <option [ngValue]="null">Select Warehouse</option>
    <option *ngFor="let w of warehouses" [ngValue]="w.id">
      {{ w.name }} ({{ w.location }})
    </option>
  </select>

</div>

<!-- ===================== INVENTORY INTELLIGENCE ===================== -->

<div *ngIf="selectedWarehouseId" class="card">

  <h3>Inventory Intelligence</h3>

  <!-- Summary -->
  <div class="inventory-summary">

    <div class="summary-box">
      <strong>Total Products</strong>
      <div>{{ inventory.length }}</div>
    </div>

    <div class="summary-box warning">
      <strong>Low Stock</strong>
      <div>{{ lowStockItems.length }}</div>
    </div>

    <div class="summary-box danger">
      <strong>Critical</strong>
      <div>{{ criticalStockItems.length }}</div>
    </div>

  </div>

  <!-- Toggle -->
  <div class="filter-row">
    <label>
      <input type="checkbox"
             [(ngModel)]="showOnlyLowStock">
      Show only low stock
    </label>
  </div>

  <!-- Table -->
  <table *ngIf="displayedInventory.length > 0">

    <tr>
      <th>Product</th>
      <th>SKU</th>
      <th>Quantity</th>
      <th>Threshold</th>
      <th>Status</th>
      <th>Controls</th>
    </tr>

    <tr *ngFor="let item of displayedInventory">

      <td>{{ item.productName }}</td>
      <td>{{ item.sku }}</td>
      <td>{{ item.quantity }}</td>
      <td>{{ item.reorderThreshold }}</td>

      <td>
        <span class="stock-badge"
              [ngClass]="getStockStatus(item)">
          {{ getStockStatus(item) | uppercase }}
        </span>
      </td>

      <td class="action-buttons">

        <button class="btn-yellow small"
                (click)="updateStock(item.productId, 10)">
          +10
        </button>

        <button class="btn-red small"
                (click)="updateStock(item.productId, -10)">
          -10
        </button>

      </td>

    </tr>

  </table>

  <div *ngIf="!loading && displayedInventory.length === 0">
    No inventory data found.
  </div>

</div>
